<!DOCTYPE html>
<html>
<head>
  <title>Plane Shooter Game</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: black;
      width: 100%;
      height: 100%;
      font-family: Arial, sans-serif;
      touch-action: none; /* prevent double-tap zoom */
    }
    canvas {
      display: block;
      background: #000;
      width: 100vw;
      height: 100vh;
    }
    #controls {
      position: fixed;
      bottom: 10px;
      width: 100%;
      z-index: 10;
      display: flex;
      justify-content: space-between;
      padding: 0 20px;
    }
    #controls .group {
      display: flex;
    }
    #controls .group button,
    #shootBtn {
      background: rgba(255,255,255,0.1);
      border: 1px solid #888;
      color: white;
      font-size: 24px;
      padding: 16px 24px;
      margin: 0 5px;
      border-radius: 8px;
      cursor: pointer;
    }
    #startButton, #restartButton {
      position: fixed;
      bottom: 50%;
      left: 50%;
      transform: translate(-50%, 50%);
      background: rgba(255,255,255,0.1);
      border: 1px solid #888;
      color: white;
      font-size: 28px;
      padding: 16px 32px;
      border-radius: 8px;
      cursor: pointer;
      z-index: 10;
      display: none;
    }
  </style>
</head>
<body>
<canvas id="gameCanvas"></canvas>

<!-- Control Buttons -->
<div id="controls">
  <div class="group">
    <button id="leftBtn">‚óÄÔ∏è</button>
    <button id="rightBtn">‚ñ∂Ô∏è</button>
  </div>
  <button id="shootBtn">üî´</button>
</div>

<!-- Start and Restart Buttons -->
<button id="startButton">Start Game</button>
<button id="restartButton">Restart Game</button>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

// Set canvas to fill screen
function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resizeCanvas();
window.addEventListener("resize", resizeCanvas);

// Load images
const planeImg = new Image();
planeImg.src = "plane.png";

const enemyImg = new Image();
enemyImg.src = "enemy.png";

const bgImg = new Image();
bgImg.src = "background.png";

// Load sounds
const shootSound = new Audio("shoot.mp3");
const explosionSound = new Audio("explosion.mp3");

// Game state
let gameState = "start"; // start | playing | gameover

// Player and game data
let plane = { x: canvas.width / 2 - 20, y: canvas.height - 80, w: 40, h: 40 };
let bullets = [];
let enemies = [];
let score = 0;

// Buttons
const startButton = document.getElementById("startButton");
const restartButton = document.getElementById("restartButton");
const controls = document.getElementById("controls");

// Show Start button initially
startButton.style.display = "block";
controls.style.display = "none";
restartButton.style.display = "none";

// Start game button
startButton.addEventListener("click", () => {
  gameState = "playing";
  startButton.style.display = "none";
  controls.style.display = "flex";
});

// Restart game button
restartButton.addEventListener("click", () => {
  resetGame();
  gameState = "playing";
  restartButton.style.display = "none";
  controls.style.display = "flex";
});

// Keyboard controls
document.addEventListener("keydown", e => {
  if (gameState === "playing") {
    if (e.key === "ArrowLeft" && plane.x > 0) plane.x -= 40;
    if (e.key === "ArrowRight" && plane.x < canvas.width - plane.w) plane.x += 40;
    if (e.key === " " || e.key === "ArrowUp") shoot();
  }
});

// Mobile controls
document.getElementById("leftBtn").addEventListener("touchstart", () => {
  if (gameState === "playing" && plane.x > 0) plane.x -= 40;
});
document.getElementById("rightBtn").addEventListener("touchstart", () => {
  if (gameState === "playing" && plane.x < canvas.width - plane.w) plane.x += 40;
});
document.getElementById("shootBtn").addEventListener("touchstart", () => {
  if (gameState === "playing") shoot();
});

// Shoot function
function shoot() {
  bullets.push({ x: plane.x + plane.w / 2 - 2, y: plane.y });
  shootSound.pause();
  shootSound.currentTime = 0;
  shootSound.play().catch(err => console.log("Shoot sound error:", err));
}

// Reset game
function resetGame() {
  plane = { x: canvas.width / 2 - 20, y: canvas.height - 80, w: 40, h: 40 };
  bullets = [];
  enemies = [];
  score = 0;
}

// Drawing functions
function drawBackground() {
  ctx.drawImage(bgImg, 0, 0, canvas.width, canvas.height);
}

function drawPlane() {
  ctx.drawImage(planeImg, plane.x, plane.y, plane.w, plane.h);
}

function drawBullets() {
  ctx.fillStyle = "red";
  bullets.forEach(b => {
    b.y -= 10;
    ctx.fillRect(b.x, b.y, 4, 10);
  });
  bullets = bullets.filter(b => b.y > -10);
}

function drawEnemies() {
  if (Math.random() < 0.02) {
    enemies.push({ x: Math.random() * (canvas.width - 40), y: -40 });
  }
  enemies.forEach(e => {
    e.y += 3;
    ctx.drawImage(enemyImg, e.x, e.y, 40, 40);
  });
  enemies = enemies.filter(e => e.y < canvas.height + 40);
}

function checkCollisions() {
  for (let i = enemies.length - 1; i >= 0; i--) {
    for (let j = bullets.length - 1; j >= 0; j--) {
      const e = enemies[i];
      const b = bullets[j];
      if (
        b.x < e.x + 40 &&
        b.x + 4 > e.x &&
        b.y < e.y + 40 &&
        b.y + 10 > e.y
      ) {
        enemies.splice(i, 1);
        bullets.splice(j, 1);
        score++;
        explosionSound.pause();
        explosionSound.currentTime = 0;
        explosionSound.play().catch(err => console.log("Explosion sound error:", err));
        break;
      }
    }
  }
}

function checkGameOver() {
  for (let e of enemies) {
    if (e.y + 40 >= plane.y) {
      gameState = "gameover";
      controls.style.display = "none";
      restartButton.style.display = "block";
    }
  }
}

function drawScore() {
  ctx.fillStyle = "white";
  ctx.font = "20px Arial";
  ctx.fillText("Score: " + score, 10, 30);
}

function drawStartScreen() {
  ctx.fillStyle = "black";
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  ctx.fillStyle = "white";
  ctx.font = "28px Arial";
  ctx.fillText("Arcade Plane Shooter", canvas.width / 2 - 120, canvas.height / 2 - 20);
}

function drawGameOver() {
  ctx.fillStyle = "rgba(0, 0, 0, 0.7)";
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  ctx.fillStyle = "red";
  ctx.font = "32px Arial";
  ctx.fillText("Game Over", canvas.width / 2 - 90, canvas.height / 2 - 20);
  ctx.fillStyle = "white";
  ctx.font = "20px Arial";
  ctx.fillText("Score: " + score, canvas.width / 2 - 40, canvas.height / 2 + 20);
}

// Game loop
function gameLoop() {
  if (gameState === "start") {
    drawStartScreen();
  } else if (gameState === "playing") {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    drawBackground();
    drawPlane();
    drawBullets();
    drawEnemies();
    checkCollisions();
    checkGameOver();
    drawScore();
  } else if (gameState === "gameover") {
    drawGameOver();
  }
  requestAnimationFrame(gameLoop);
}

gameLoop();
</script>
</body>
</html>
